!function(t,n){"object"==typeof exports&&"object"==typeof module?module.exports=n():"function"==typeof define&&define.amd?define("BtgTracking",[],n):"object"==typeof exports?exports.BtgTracking=n():t.BtgTracking=n()}(this,function(){return(this.webpackChunkBtgTracking=this.webpackChunkBtgTracking||[]).push([[792],{273:function(){!function BtgTracking(){var t,n=`https://${window.location.hostname.replace("checkout","www")}/graphql`,e="btg360.com.br";function o(t,n,e){var o,c=new Date;c.setTime(c.getTime()+24*e*60*60*1e3),o=t+"="+n+"; ",o+="expires="+c.toUTCString()+"; ",document.cookie=o+"path=/; domain=."+document.domain}function c(t){t+="=";for(var n=document.cookie.split(";"),e=n.length,o=0;o<e;o++){for(var c=n[o];" "===c.charAt(0);)c=c.substring(1);if(0===c.indexOf(t))return c.substring(t.length,c.length)}return!1}function r(t){c(t)&&o(t,null,-1)}function a(){var t,n=c("__bid");return n||(t=(new Date).getTime(),o("__bid",n="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(n){var e=(t+16*Math.random())%16|0;return t=Math.floor(t/16),("x"===n?e:3&e|8).toString(16)}),21900)),n}function i(t,n){var o=document.location.protocol+"//"+t+"."+e+"/"+n;return o}function s(t){return new String(t).replace(/[a-zA-Z\$\s]/g,"").replace(/\,/g,".")}function u(t){return void 0===t||["undefined","null"].indexOf(String(t).toLowerCase())>=0?"":encodeURIComponent(t)}function d(t,n){for(var e=n.length,o=!1,c=0;c<e;c++)n[c]===t&&(o=!0);return o}function p(){for(var t=[],n=document.location.search.slice(1).split("&"),e=n.length,o=0;o<e;o++){var c=n[o].split("=");t[decodeURIComponent(c[0])]=c[1]||""}return t}function f(t,n){for(var e=t.split(n),o=e[0],c=e.length,r=1;r<c;r++)o+=e[r].charAt(0).toUpperCase()+e[r].slice(1);return o}function h(t,n){new Image(1,1).src=t+"?"+n}function l(n){var e,o,r="btgId="+n;return r+="&cookieBid="+t,r+="&url="+u(window.location.href),r+="&rand="+(e=!0,o=Math.random(),void 0!==e&&e?o.toString().substr(2):o),r+=c("__btgUtms")||""}function m(t,n){if(void 0===t[0])return!1;if("string"==typeof t[0].email||"string"==typeof t[0].token){var e,o=l(n),c=u(t[0].usid);c&&(e+="&usid="+c,t[0].email="");var r=void 0===t[0].isOptin||t[0].isOptin;e+="&email="+u(t[0].email),e+="&facebookId="+u(t[0].facebookId),e+="&webPushId="+u(t[0].webPushId),e+="&phone="+u(t[0].phone),e+="&token="+u(t[0].token),e+="&encrypt="+u(t[0].encrypt),e+="&isOptin="+r,h(i("c","__client.gif"),o+e)}}function g(t,n,e,o){if("object"!=typeof t)throw{message:"BTG360 Info - "+o+" image was not generated."};var c=l(e),a="&email="+u(t.email);a+="&id="+u(t.productId),a+="&name="+u(t.productName),a+="&price="+s(t.prices.priceTables[0].price),a+="&department="+u(n[0]?.name||""),a+="&category="+u(n[1]?.name||""),a+="&subcategory="+u(n[2]?.name||""),a+="&brand="+u(t.productBrand.name),h(i("c","__"+o+".gif"),c+a),"product"===o&&r("btg_lastprod")}function w(t,n,e,o){var r,a=l(n),d=t.length,p=c("__btgModule");if(d<=0)throw{message:"BTG360 Info - Transaction image was not generated."};var f=s(t.prices.priceTables[0].price);r="&email="+u(t.email),r+="&transactionId="+u(o),r+="&id="+u(t.productId),r+="&name="+u(t.productName),r+="&price="+f,r+="&department="+u(e[0]?.name||""),r+="&category="+u(e[1]?.name||""),r+="&subcategory="+u(e[2]?.name||""),r+="&brand="+u(t.productBrand.name),h(i("c","__order.gif"),a+r),function(t,n){if(t){var e=l();e+="&moduleId="+t,e+="&transactionId="+u(n.transactionId),e+="&productId="+u(n.id),h(i("c","__module.gif"),e)}}(p,t)}function k(t,n){if("object"!=typeof t[0])throw{message:"BTG360 Info - Search image was not generated."};var e=l(n),o=u(t[0].keyword),c=void 0!==t[0].minSizeChar?parseInt(t[0].minSizeChar):2;o.length>=c&&(e+="&keyword="+o,h(i("c","__search.gif"),e))}function I(t,n){if("object"!=typeof t[0])throw{message:"BTG360 Info - Wishlist image was not generated."};var e=l(n),o=void 0!==t[0].active&&(t[0].active||parseInt(t[0].active))?1:0;e+="&productId="+u(t[0].productId),e+="&active="+o,h(i("c","__wishlist.gif"),e)}function v(t,n){if("object"!=typeof t[0])throw{message:"BTG360 Info - Warnme image was not generated."};var e=l(n),o=void 0!==t[0].active&&(t[0].active||parseInt(t[0].active))?1:0;e+="&productId="+u(t[0].productId),e+="&active="+o,h(i("c","__warnme.gif"),e)}function b(){var t,n;u((t=p()).btg_source)&&m([{email:t.btg_source,usid:t.btg_source}]),function(){r("BTG360_utms");var t=["utm_source","utm_medium","utm_term","utm_content","utm_campaign","utm_adContent","utm_uid","utm_email","utm_keyword"],n=p(),e="";for(var c in n)d(c,t)&&(e+="&"+f(c,"_")+"="+u(n[c]));e&&o("__btgUtms",e,2)}(),(n=u(p().btg_module))&&o("__btgModule",n,1)}function BtgSend(t,n,e,o,c){if("email"===n||"client"===n)m(e,t);else if("cart"===n||"product"===n){l(t);if(e.length<=0)throw{message:"BTG360 Info - "+n+" image was not generated."};g(e,o,t,n)}else"transaction"===n?w(e,t,o,c):"search"===n&&k(e,t)}const _=(()=>{let t;return{getInstance(){return t||(t=function(){const t={};return document.cookie.split("; ").forEach(n=>{const[e,...o]=n.split("=");try{t[decodeURIComponent(e)]=decodeURIComponent(o.join("="))}catch{t[e]=o.join("=")}}),{getAll(){return t},get(n){return t[n]||null}}}()),t}}})(),y=_.getInstance().get("sf_storefront_access_token");function T(t,e,o){var c="query Query { products(first: 50, filters: { "+o+": "+parseInt(t,10)+" }) {   edges { node {     productId productName productBrand { name }     productCategories { name }     prices { priceTables { price } }   } } } }";const r={customerAccessToken:_.getInstance().get("sf_customer_access_token")};return new Promise(function(t,o){fetch(n,{method:"POST",headers:{Accept:"application/json","TCS-Access-Token":e,"Content-Type":"application/json"},body:JSON.stringify({query:c,variables:r})}).then(function(t){return t.ok?t.json():o(new Error("Http Error: "+t.status))}).then(function(n){n?.data?.products?.edges?.length>0?t(n.data.products.edges[0].node):o(new Error("Produto nÃ£o encontrado na resposta"))}).catch(function(t){o(t)})})}this.start=function(e,o){var c,i;if(i=!1,"string"==typeof(c=e)&&/[0-9]\:[0-9]/g.test(c)&&(i=c),!i)throw{message:"BTG360 Info - Account unknown."};t=a(),b();o=function(t){var n=!1;return"string"==typeof t&&/^tcs_[a-z0-9]+_[a-f0-9]{32}$/g.test(t)&&(n=t),n}(o);if(!o)throw{message:"BTG360 Info - TCS token invalid."};new Promise(function(t,n){var e,o=window.location.hostname.replace(/^www\./,"");e=window.location.hostname.includes("checkout")?"https://"+window.location.hostname+"/api/Login/Get":"https://checkout."+o+"/api/Login/Get",fetch(e,{method:"GET",headers:{accept:"application/json"},credentials:"include"}).then(function(t){return t.json()}).then(function(o){if(null==o){const o=_.getInstance().get("sf_customer_access_token");if(e="https://"+window.location.hostname+"/graphql",o){const c="query Customer($customerAccessToken: String!) {\n                        data: customer(customerAccessToken: $customerAccessToken) {\n                            id\n                            email\n                            customerName\n                            companyName\n                            customerType\n                            cnpj\n                            cpf\n                            phoneNumber\n                        }\n                        }",r={customerAccessToken:o};fetch(e,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json","TCS-Access-Token":y},body:JSON.stringify({query:c,variables:r})}).then(function(t){return t.json()}).then(function(n){const e={email:n.data.data.email,phone:n.data.data.phoneNumber.replace(/\D/g,"")};t(e)}).catch(function(t){n(t)})}}else t(o)}).catch(function(t){n(t)})}).then(function(t){BtgSend(e,"client",[{email:t?.Email||t?.email||"",phone:t?.Phone||t?.phone||""}],null,null)}).catch(function(t){});var s,u,d=window.location.hostname,p=window.location.pathname;if(-1!==d.indexOf("checkout")){if("/"===p)(u="https://"+window.location.hostname+"/api/carrinho",fetch(u,{method:"GET",headers:{accept:"application/json"},credentials:"include"}).then(function(t){return 200===t.status?t.json():void 0}).catch(function(t){})).then(function(t){t.Produtos.forEach(function(t){T(t.ProdutoId,o,"productId").then(function(t){var n=t.productCategories;BtgSend(e,"cart",t,n,null)}).catch(function(t){})})}).catch(function(t){});else if("/Confirmacao"===p){var f=Fbits.Carrinho,h=f.PedidoId;f.Produtos.map(function(t){T(t.ProdutoId,y,"productVariantId").then(function(t){var n=t.productCategories;BtgSend(e,"transaction",t,n,h),r("__btgModule"),r("__btgUtms")}).catch(function(t){})})}}else-1!==p.indexOf("checkout")&&-1===window.location.search.indexOf("checkoutId")?function(){var t="https://"+window.location.hostname+"/graphql";const n={checkoutId:_.getInstance().get("carrinho-id")};return new Promise(function(e,o){fetch(t,{method:"POST",headers:{"Content-Type":"application/json","TCS-Access-Token":y},body:JSON.stringify({query:"query Checkout($checkoutId: String!) {\n    data: checkout(checkoutId:$checkoutId) {\n    checkoutId\n    url\n    products {\n      name\n      productAttributes {\n        name\n        value\n        type\n      }\n      listPrice\n      price\n      ajustedPrice\n      productId\n      productVariantId\n      imageUrl\n      quantity\n      customization{\n        id\n        values{\n          cost\n          name\n          value\n        }\n      }\n    }\n    shippingFee\n    subtotal\n    total\n  }\n}",variables:n})}).then(function(t){return t.json()}).then(function(t){e(t.data.data.products)}).catch(function(t){o(new Error("Erro ao buscar 2 produtos do carrinho:",t))})})}().then(function(t){t.map(t=>{T(t.imageUrl.split("/")[5],y,"productVariantId").then(function(t){const n=t.productCategories;BtgSend(e,"cart",t,n,null)})})}):-1!==p.indexOf("confirmation")&&-1!==window.location.search.indexOf("checkoutId")&&(window.location.hostname,new Promise(function(t,e){const o=window.location.search,c=new URLSearchParams(o).get("checkoutId"),r=_.getInstance().get("sf_storefront_access_token");c&&(s={checkoutId:c},fetch(n,{method:"POST",headers:{"Content-Type":"application/json","TCS-Access-Token":r},body:JSON.stringify({query:"query Checkout($checkoutId: String!) {\n          data: checkout(checkoutId: $checkoutId) {\n            checkoutId\n            completed\n            cep\n            orders {\n              date\n              orderStatus\n              orderId\n              totalValue\n              discountValue\n              shippingValue\n              products {\n                productVariantId\n                imageUrl\n                name\n                quantity\n                value\n                attributes {\n                  name\n                  value\n                }\n              }\n            }\n            subtotal\n            discount\n            shippingFee\n            paymentFees\n            total\n          }\n        }",variables:s})}).then(function(t){return t.json()}).then(function(n){t(n.data.data)}).catch(function(t){e(new Error("Erro ao buscar 2 produtos do carrinho:",t))}))})).then(function(t){const n=t.orders[0].products,o=t.orders[0].orderId;n.map(t=>{T(t.imageUrl.split("/")[5],y,"productVariantId").then(function(t){const n=t.productCategories;BtgSend(e,"transaction",t,n,o)})})});if(-1!==p.indexOf("/produto/")){var l=p.split("-");T(l[l.length-1],o).then(function(t){if(BtgSend(e,"product",t,{productCategories:t.productCategories},null),"function"==typeof wishlistAddClick){var n=wishlistAddClick;window.wishlistAddClick=function(...o){const c=n.apply(this,o);return I([{productId:t.productId,active:!0}],e),c}}if("function"==typeof backInStockOnClick){var o=backInStockOnClick;window.backInStockOnClick=function(...n){const c=o.apply(this,n);return v([{productId:t.productId,active:!0}],e),c}}}).catch(function(t){})}if(-1!==p.indexOf("/busca")){var m=window.location.search,g=new URLSearchParams(m).get("busca");BtgSend(e,"search",[{keyword:g}],null,null)}},window.BtgTracking=this}()}},function(t){var n;return n=273,t(t.s=n)}])});